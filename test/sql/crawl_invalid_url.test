# name: test/sql/crawl_invalid_url.test
# description: Test that CRAWL rejects invalid URL/hostname input
# group: [crawler]

require crawler

# Test integer input
statement error
CRAWL (SELECT 1) INTO test_invalid WITH (user_agent 'Test/1.0');
----
invalid URL/hostname values

# Test string without dot (not a valid domain)
statement error
CRAWL (SELECT 'notadomain') INTO test_invalid WITH (user_agent 'Test/1.0');
----
invalid URL/hostname values

# Test empty string
statement error
CRAWL (SELECT '') INTO test_invalid WITH (user_agent 'Test/1.0');
----
invalid URL/hostname values

# Test invalid protocol
statement error
CRAWL (SELECT 'ftp://example.com') INTO test_invalid WITH (user_agent 'Test/1.0');
----
invalid URL/hostname values

# Test hostname starting with dot
statement error
CRAWL (SELECT '.example.com') INTO test_invalid WITH (user_agent 'Test/1.0');
----
invalid URL/hostname values

# Test hostname ending with dot
statement error
CRAWL (SELECT 'example.com.') INTO test_invalid WITH (user_agent 'Test/1.0');
----
invalid URL/hostname values
